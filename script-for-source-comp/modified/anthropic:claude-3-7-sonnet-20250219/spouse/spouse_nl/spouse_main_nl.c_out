struct person {
char* name;
struct person* spouse;
};
struct person *create_person()
{
struct person *p = malloc(sizeof(struct person));
if(p == 0) abort();
p->spouse = 0;
return p;
}
void marry(struct person *this, struct person *other)
{
this->spouse = other;
other->spouse = this;
}
void divorce(struct person* this)
{
struct person* spouse_ptr = this->spouse;
spouse_ptr->spouse = 0;
this->spouse = 0;
}
void die(struct person *this)
{
if(this->spouse != 0) {
struct person* spouse_ptr = this->spouse;
spouse_ptr->spouse = 0;
} else {
}
free(this);
}
int main()
{
struct person* alice = create_person();
struct person* bob = create_person();
struct person* eve = 0;
marry(alice, bob);
eve = create_person();
divorce(bob);
marry(bob, eve);
die(alice);
die(bob);
die(eve);
return 0;
}
